#!/bin/bash -e

echo "Grabbing terraform modules:"

terraform get

echo "Setting up configuration:"

cp config.tfvars.template config.tfvars

discovery_url=$(curl -s -w "\n" 'https://discovery.etcd.io/new?size=3')

sed -i'.bak' -e "s|DISCOVERY_URL|$discovery_url|" config.tfvars

rm config.tfvars.bak

echo "config.tfvars ready - Update DO_READ_TOKEN!!!"
echo "Be sure to update your secrets file."
